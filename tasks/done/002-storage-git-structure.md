# Cтруктура хранения репозиториев и файлов

## Контекст
Контент статей (блоков) хранится в Git-репозиториях для версионирования и совместной работы.

## Задачи
- Спроектировать генератор инициализации `/data/git/<article-slug>.git` и структуру файлов блоков.
- Реализовать соглашения об именовании файлов (`<lang>/b<id>-<label>.md`) и метаданные в коммитах.
- Определить обязательные метаданные блока: помимо тела в `.md` файле сохранять заголовок и уровень заголовка для каждой альтернативы (в БД и manifest).
- Настроить сервис взаимодействия с локальными Git-репозиториями (создание, чтение истории, diff, push).
- Обеспечить включение ссылки на источник в каждое сообщение коммита.

## Критерии приёмки
- Созданы утилиты для создания и клонирования bare-репозиториев статей.
- Поддерживается чтение и запись альтернативных блоков через сервис Git API.
- Есть документация по структуре репозитория и форматам файлов, включая правила хранения заголовков и уровней блоков.
- Реализованы тесты на атомарность блоков и хранение альтернатив.
- Определить структуру хранения: один репозиторий на статью (`{article_id}.git`).
- Файлы блоков именуются по языку и ID: `{lang}/b{block_id}-{label}.md`.
- Использовать bare-репозитории для экономии места и прямого доступа.
- Реализовать `GitRepositoryClient` для изоляции `simple-git` и управления worktree.
- Клиент создаёт bare-репозиторий при первом коммите в статью.
- Временные worktree используются для атомарных коммитов и автоматически очищаются.
- Файловая структура соответствует формату `{lang}/b{block_id}-{label}.md`.
- Тесты проверяют создание репозитория, коммит и чтение файлов.
